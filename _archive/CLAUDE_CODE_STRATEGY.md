# CLAUDE CODE DYNAMIC FIX STRATEGY FOR DR-ISLAM-WEBSITE

**Generated by Claude Desktop with Website Building Expertise**
**Date:** August 4, 2025
**Target:** Claude Code with MCP servers

## 🎯 EXECUTION STRATEGY

### PHASE 1: DYNAMIC CONTEXT BUILDING
Claude Code should start EVERY session with:
```
1. Read WEBSITE_FIX_TODO.md to understand current status
2. Use context7 to fetch latest docs for:
   - "Cloudflare Workers use context7"
   - "CSS-in-JS best practices use context7"
   - "Mobile-first responsive design use context7"
   - "Arabic RTL implementation use context7"
```

### PHASE 2: AUTOMATED TESTING WORKFLOW
For EVERY fix, Claude Code must:
```
1. Make the fix
2. Run: npm run dev
3. Use playwright-automation to:
   - Navigate to http://127.0.0.1:8787
   - Test desktop view (1200px)
   - Test mobile view (375px)
   - Test Arabic version (/ar/)
   - Take screenshots for verification
```

## 📋 PRIORITY FIX ORDER (WITH DYNAMIC APPROACHES)

### 1. **CRITICAL SECURITY: Admin Token** (15 min)
**Dynamic Approach:**
```
# Step 1: Search for security best practices
"Cloudflare Workers environment variables security use context7"

# Step 2: Fix wrangler.toml
- Remove ADMIN_TOKEN from line 18
- Add comment: # Set ADMIN_TOKEN in Cloudflare Dashboard

# Step 3: Verify with playwright
- Test gallery API returns 401 without token
- Document in SECURITY_FIXED.md
```

### 2. **Test Infrastructure** (2 hours)
**Dynamic Approach:**
```
# Step 1: Get testing framework docs
"Vitest Cloudflare Workers testing use context7"
"Playwright API testing use context7"

# Step 2: Create test structure
tests/
├── integration/
│   ├── gallery.test.js      # Gallery API tests
│   └── routing.test.js      # Arabic routing fix
├── performance/
│   └── lighthouse.test.js   # Core Web Vitals
├── accessibility/
│   └── wcag.test.js        # A11y compliance
└── mobile/
    └── touch.test.js       # Mobile interactions

# Step 3: Use playwright for E2E tests
- Test all user flows
- Verify mobile touch targets (48px)
- Check Arabic RTL rendering
```

### 3. **CSS Architecture Consolidation** (3 hours)
**Dynamic Approach:**
```
# Step 1: Research modern CSS architecture
"CSS-in-JS modular architecture 2025 use context7"
"PostCSS optimization techniques use context7"

# Step 2: Consolidate 10+ CSS files into 3:
src/content/css/
├── critical.css.js     # Above-fold styles only
├── components.css.js   # All component styles
└── responsive.css.js   # All media queries

# Step 3: Use playwright to verify:
- No visual regressions
- Performance improvement
- Mobile responsiveness intact
```

### 4. **Arabic Routing Fix** (30 min)
**Dynamic Approach:**
```
# Step 1: Get routing best practices
"URL parameter handling JavaScript use context7"

# Step 2: Fix in src/index.js handleHTMLRequest():
const url = new URL(request.url);
const langParam = url.searchParams.get('lang');
const isArabic = pathname.startsWith('/ar/') || langParam === 'ar';

# Step 3: Test with playwright:
- /?lang=ar shows Arabic
- /ar/ shows Arabic
- Cookie persistence works
```

### 5. **Missing UI Components** (2 hours)
**Dynamic Approach:**
```
# Step 1: Get component patterns
"FAQ search implementation vanilla JS use context7"
"Service comparison table responsive design use context7"

# Step 2: Implement missing features:
- FAQ search for Arabic (copy from English)
- Service comparison tables (desktop/mobile)
- Breadcrumb navigation

# Step 3: Playwright validation:
- Search functionality works
- Tables responsive on mobile
- RTL support verified
```

## 🤖 DYNAMIC DECISION PATTERNS

### When Facing CSS Issues:
```javascript
// Claude Code should ask context7:
"[specific CSS problem] modern solution use context7"
// Example: "CSS Grid vs Flexbox for RTL layouts use context7"
```

### When Facing JavaScript Issues:
```javascript
// Get latest patterns:
"[JS feature] Cloudflare Workers compatible use context7"
// Test immediately with playwright
```

### When Facing Mobile Issues:
```javascript
// Research first:
"Mobile touch optimization 2025 best practices use context7"
// Validate with playwright at 375px viewport
```

## 🔄 AUTOMATED VALIDATION LOOP

Claude Code should create this validation script:
```javascript
// validation.js
const playwright = require('playwright');

async function validateFix(fixType) {
  // 1. Start dev server
  // 2. Use playwright to test
  // 3. Take screenshots
  // 4. Compare with baseline
  // 5. Report results
}

// Run after EVERY change
```

## 📊 SUCCESS METRICS

Claude Code should track and report:
1. **Security Score**: A+ (after admin token fix)
2. **Performance**: Lighthouse 95+ maintained
3. **Mobile Usability**: All touch targets 48px+
4. **Arabic Parity**: 100% feature coverage
5. **Test Coverage**: 80%+ for critical paths

## 💡 CONTEXT7 POWER QUERIES

Essential queries Claude Code should use:
```
"Cloudflare Workers R2 optimization 2025 use context7"
"Arabic RTL CSS best practices 2025 use context7"
"Mobile-first responsive breakpoints 2025 use context7"
"JavaScript performance optimization Edge Workers use context7"
"WCAG 2.1 AA compliance checklist use context7"
```

## 🚀 GITHUB PUSH STRATEGY

After each major fix:
```bash
git add .
git commit -m "fix: [specific issue] - verified with playwright"
git push origin main
# Auto-deploy to Cloudflare happens
```

## ⚠️ CRITICAL WARNINGS

1. **NEVER** commit sensitive data (check with context7 for patterns)
2. **ALWAYS** test mobile + Arabic before pushing
3. **VERIFY** with playwright - no assumptions
4. **USE** context7 for ANY uncertainty

## 📝 FINAL DELIVERABLE

Claude Code should create:
```
FIXES_COMPLETE_REPORT.md
├── Security fixes applied ✓
├── Test coverage implemented ✓
├── Performance maintained ✓
├── Mobile/Arabic parity achieved ✓
└── Deployment successful ✓
```

---
**This strategy enables Claude Code to work dynamically, always getting latest best practices via context7 and validating with playwright automation.**